name: Push Event Types to Artsdata
on:
  workflow_dispatch:
  push:
    branches:
      - main
    paths:
      - 'controlled-vocabulary/**'
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Set current date as output
        id: version  # this is used on variable path
        run: echo "dumpdate=$(date +'%Y-%m-%dT%H-%M-%S')" >> $GITHUB_OUTPUT
      - name: Call Artsdata Databus
        run: |
          curl \
          -H 'Content-Type: application/json' \
          -X POST http://api.artsdata.ca/databus/  \
          --data '{ "artifact": "capacoa-vocabulary",
                    "comment": "CAPACOA Vocabulary in SKOS format",
                    "publisher": "${{ secrets.PUBLISHER_URI_GREGORY }}",
                    "group": "${{ github.event.repository.name }}",
                    "version": "${{ steps.version.outputs.dumpdate }}",
                    "downloadUrl": "https://raw.githubusercontent.com/${{github.repository}}/${{github.ref}}/controlled-vocabulary/capacoa-controlled-vocab-skos.ttl",
                    "downloadFile": "capacoa-controlled-vocab-skos.ttl",
                    "shacl": "skos"
                  }'   
  # artsdata-push:
  #   runs-on: ubuntu-latest
  #   steps:
  #     - name: Action setup
  #       uses: culturecreates/artsdata-pipeline-action@v3
  #       with:
  #           artifact: capacoa-vocabulary
  #           publisher: "${{ secrets.PUBLISHER_URI_GREGORY }}"
  #           downloadUrl: https://raw.githubusercontent.com/${{github.repository}}/${{github.ref}}/controlled-vocabulary/capacoa-controlled-vocab-skos.ttl,
  #           shacl: skos